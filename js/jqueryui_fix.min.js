
$.ui.ddmanager.frameOffsets={};$.ui.ddmanager.prepareOffsets=function(k,a){var d,c,b=$.ui.ddmanager.droppables[k.options.scope]||[],f=a?a.type:null,e=(k.currentItem||k.element).find(":data(ui-droppable)").addBack(),h,g;droppablesLoop:for(d=0;d<b.length;d++){if(b[d].options.disabled||(k&&!b[d].accept.call(b[d].element[0],(k.currentItem||k.element)))){continue}for(c=0;c<e.length;c++){if(e[c]===b[d].element[0]){b[d].proportions().height=0;continue droppablesLoop}}b[d].visible=b[d].element.css("display")!=="none";if(!b[d].visible){continue}if(f==="mousedown"){b[d]._activate.call(b[d],a)}b[d].offset=b[d].element.offset();proportions={width:b[d].element[0].offsetWidth,height:b[d].element[0].offsetHeight};typeof b[d].proportions==="function"?b[d].proportions(proportions):(b[d].proportions=proportions);if((h=b[d].document[0])!==document){g=$.ui.ddmanager.frameOffsets[h];if(!g){g=$.ui.ddmanager.frameOffsets[h]=$((h.defaultView||h.parentWindow).frameElement).offset()}b[d].offset.left+=g.left;b[d].offset.top+=g.top}}};